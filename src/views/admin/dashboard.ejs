<!-- ============================================================== -->
<!-- Start Page Content here -->
<!-- ============================================================== -->
<div class="content">

  <!-- Start Content-->
  <div class="container-fluid">

    <!-- start page title -->
    <div class="row">
      <div class="col-12">
        <div class="page-title-box">
          <div class="page-title-right">
            <ol class="breadcrumb m-0">
              <li class="breadcrumb-item"><a href="/admin/dashboard">Barrel&Vine</a></li>
              <li class="breadcrumb-item active">Dashboard</li>
            </ol>
          </div>
          <h4 class="page-title">Dashboard</h4>
        </div>
      </div>
    </div>
    <!-- end page title -->

    <div class="row">
      <div class="col-md-6 col-xl-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-12">
                <h5 class="text-muted fw-normal mt-0 text-truncate" title="Campaign Sent">Orders Today</h5>
                <h3 class="my-2 py-1">
                  <%= stats.ordersToday.toLocaleString() %>
                </h3>
                <p class="mb-0 text-muted">
                  <% if (stats.ordersChange >= 0) { %>
                  <span class="text-success me-2">
                    <i class="mdi mdi-arrow-up-bold"></i>
                    <%= stats.ordersChange.toFixed(2) %>%
                  </span>
                  <% } else if (stats.ordersChange < 0) { %>
                  <span class="text-danger me-2">
                    <i class="mdi mdi-arrow-down-bold"></i>
                    <%= Math.abs(stats.ordersChange).toFixed(2) %>%
                  </span>
                  <% } %>
                </p>
              </div>

              <!-- <div class="col-6">
                <div class="text-end">
                  <div id="campaign-sent-chart" data-colors="#727cf5"></div>
                </div>
              </div> -->
            </div> <!-- end row-->
          </div> <!-- end card-body -->
        </div>
        <!-- end card -->
      </div> <!-- end col -->

      <div class="col-md-6 col-xl-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-12">
                <h5 class="text-muted fw-normal mt-0 text-truncate" title="New Leads">New Customers</h5>
                <h3 class="my-2 py-1">
                  <%= stats.newCustomers.toLocaleString() %>
                </h3>
                <p class="mb-0 text-muted">
                  <% if (stats.customersChange >= 0) { %>
                  <span class="text-success me-2">
                    <i class="mdi mdi-arrow-up-bold"></i>
                    <%= stats.customersChange.toFixed(2) %>%
                  </span>
                  <% } else if (stats.customersChange < 0) { %>
                  <span class="text-danger me-2">
                    <i class="mdi mdi-arrow-down-bold"></i>
                    <%= Math.abs(stats.customersChange).toFixed(2) %>%
                  </span>
                  <% } %>
                </p>
              </div>
              <!-- <div class="col-6">
                <div class="text-end">
                  <div id="new-leads-chart" data-colors="#0acf97"></div>
                </div>
              </div> -->
            </div> <!-- end row-->
          </div> <!-- end card-body -->
        </div> <!-- end card -->
      </div> <!-- end col -->

      <div class="col-md-6 col-xl-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-12">
                <h5 class="text-muted fw-normal mt-0 text-truncate" title="Deals">Bottles Sold</h5>
                <h3 class="my-2 py-1">
                  <%= stats.bottlesSold.toLocaleString() %>
                </h3>
                <p class="mb-0 text-muted">
                  <% if (stats.bottlesChange >= 0) { %>
                  <span class="text-success me-2">
                    <i class="mdi mdi-arrow-up-bold"></i>
                    <%= stats.bottlesChange.toFixed(2) %>%
                  </span>
                  <% } else if (stats.bottlesChange < 0) { %>
                  <span class="text-danger me-2">
                    <i class="mdi mdi-arrow-down-bold"></i>
                    <%= Math.abs(stats.bottlesChange).toFixed(2) %>%
                  </span>
                  <% } %>
                </p>
              </div>
              <!-- <div class="col-6">
                <div class="text-end">
                  <div id="deals-chart" data-colors="#727cf5"></div>
                </div>
              </div> -->
            </div> <!-- end row-->
          </div> <!-- end card-body -->
        </div> <!-- end card -->
      </div> <!-- end col -->

      <div class="col-md-6 col-xl-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-12">
                <h5 class="text-muted fw-normal mt-0 text-truncate" title="Booked Revenue">Total Revenue</h5>
                <h3 class="my-2 py-1">
                  <%= stats.totalRevenue.toLocaleString() %> đ
                </h3>
                <p class="mb-0 text-muted">
                  <% if (stats.revenueChange >= 0) { %>
                  <span class="text-success me-2">
                    <i class="mdi mdi-arrow-up-bold"></i>
                    <%= stats.revenueChange.toFixed(2) %>%
                  </span>
                  <% } else if (stats.revenueChange < 0) { %>
                  <span class="text-danger me-2">
                    <i class="mdi mdi-arrow-down-bold"></i>
                    <%= Math.abs(stats.revenueChange).toFixed(2) %>%
                  </span>
                  <% } %>
                </p>
              </div>
              <!-- <div class="col-6">
                <div class="text-end">
                  <div id="booked-revenue-chart" data-colors="#0acf97"></div>
                </div>
              </div> -->
            </div> <!-- end row-->
          </div> <!-- end card-body -->
        </div> <!-- end card -->
      </div> <!-- end col -->
    </div>
    <!-- end row -->

    <div class="row">
      <div class="col-lg-5">
        <div class="card">
          <div class="d-flex card-header justify-content-between align-items-center">
            <h4 class="header-title">Top Selling Products</h4>
            <!-- <a href="javascript:void(0);" class="btn btn-sm btn-light">Export <i class="mdi mdi-download ms-1"></i></a> -->
          </div>

          <div class="card-body pt-0">
            <div class="table-responsive">
              <table class="table table-centered table-nowrap table-hover mb-0">
                <tbody>

                  <% stats.topSellingProducts.forEach((product) => { %>
                  <tr>
                    <td>
                      <h5 class="font-14 my-1 fw-normal">
                        <%= product.title.length > 30 ? product.title.slice(0, 30) + '...' : product.title %>
                      </h5>
                      <span class="text-muted font-13">ID: <%= product._id %></span>
                    </td>
                    <td>
                      <h5 class="font-14 my-1 fw-normal">
                        <%= product.price.toLocaleString('vi-VN') %> ₫
                      </h5>
                      <span class="text-muted font-13">Current Price</span>
                    </td>
                    <td>
                      <h5 class="font-14 my-1 fw-normal"><%= product.totalSold %></h5>
                      <span class="text-muted font-13">Quantity</span>
                    </td>
                    <td>
                      <h5 class="font-14 my-1 fw-normal">
                        <%= (product.priceAtPurchase * product.totalSold).toLocaleString('vi-VN') %> ₫
                      </h5>
                      <span class="text-muted font-13">Revenue</span>
                    </td>
                  </tr>
                  <% }) %>

                </tbody>
              </table>
            </div> <!-- end table-responsive-->
          </div> <!-- end card-body-->
        </div>
        <!-- end card -->
      </div>
      <!-- end col-->

      <div class="col-lg-7">
        <div class="card">
          <div class="card-header d-flex flex-column">
            <h4 class="header-title mb-2">Weekly Revenue</h4>
            <!-- <div>
              <button type="button" class="btn btn-soft-secondary btn-sm">
                ALL
              </button>
              <button type="button" class="btn btn-soft-primary btn-sm">
                1M
              </button>
              <button type="button" class="btn btn-soft-secondary btn-sm">
                6M
              </button>
              <button type="button" class="btn btn-soft-secondary btn-sm">
                1Y
              </button>
            </div>
          </div> -->

            <div class="card-body pt-0">
              <div class="chart-content-bg">
                <div class="row text-center">
                  <div class="col-sm-6">
                    <p class="text-muted mb-0 mt-3">Current Week</p>
                    <h2 class="fw-normal mb-3">
                      <span>
                        <%= stats.weeklyRevenue[stats.weeklyRevenue.length - 1].total.toLocaleString() %> đ
                      </span>
                    </h2>
                  </div>
                  <div class="col-sm-6">
                    <p class="text-muted mb-0 mt-3">Previous Week</p>
                    <h2 class="fw-normal mb-3">
                      <span>
                        <%= stats.weeklyRevenue[stats.weeklyRevenue.length - 2].total.toLocaleString() %> đ
                      </span>
                    </h2>
                  </div>
                </div>
              </div>

              <div dir="ltr">
                <div id="dash-revenue-chart" class="apex-charts" data-colors="#0acf97,#fa5c7c"></div>
              </div>

            </div>
            <!-- end card body-->
          </div>
          <!-- end card -->
        </div>
        <!-- end col-->
      </div>
      <!-- end row-->

    </div> <!-- container -->

  </div>
  <!-- ============================================================== -->
  <!-- End Page content -->
  <!-- ============================================================== -->

  <!-- Vendor js -->
  <script src="/assets/js/vendor.min.js"></script>

  <!-- ======== Start custom Js for this page ======================= -->
  <!-- Apex  Charts js -->
  <script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>

  <!-- Todo js -->
  <script src="/assets/js/ui/component.todo.js"></script>

  <!-- CRM Dashboard Demo App Js -->

  <script>
    dataColors = $("#dash-revenue-chart").data("colors"),
      options = {
        chart: {

          height: 338,
          type: "line",
          toolbar: {
            show: !1
          }
        }

        ,
        stroke: {
          curve: "smooth",
          width: 2
        }

        ,
        series: [{
            name: "Weekly Revenue",
            type: "area",
            data: <%= JSON.stringify(stats.weeklyRevenue.map(item => item.total)) %>
          }

        ],
        fill: {
          type: "solid",
          opacity: [.35, 1]
        }

        ,
        labels: <%= JSON.stringify(stats.weeklyRevenue.map(item => item.week)) %>,
        markers: {
          size: 0
        }

        ,
        colors: colors = dataColors ? dataColors.split(",") : colors,
        yaxis: [{
            title: {
              text: "Revenue (VND)"
            }

            ,
            min: 0
          }

        ],
        tooltip: {

          shared: !0,
          intersect: !1,
          y: {
            formatter: function(o) {
              return void 0 !== o ? o.toFixed(0) + "k" : o
            }
          }
        }

        ,
        grid: {

          borderColor: "#f1f3fa",
          padding: {
            bottom: 5
          }
        }

        ,
        legend: {
          fontSize: "14px",
          fontFamily: "14px",
          offsetY: 5
        }

        ,
        responsive: [{

            breakpoint: 600,
            options: {
              yaxis: {
                show: !1
              }

              ,
              legend: {
                show: !1
              }
            }
          }

        ]
      }

    ;
    (chart = new ApexCharts(document.querySelector("#dash-revenue-chart"), options)).render();
  </script>
  <!-- ======== End custom Js for this page ========================= -->

  <!-- App js -->
  <script src="/assets/js/app.min.js"></script>